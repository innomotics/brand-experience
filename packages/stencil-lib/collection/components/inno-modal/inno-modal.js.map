{"version":3,"file":"inno-modal.js","sourceRoot":"","sources":["../../../src/components/inno-modal/inno-modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Element, Prop, State, Event, EventEmitter, Method, Listen } from '@stencil/core';\r\nimport anime from 'animejs';\r\nimport { A11yAttributes, a11yBoolean, a11yHostAttributes } from '../../utils/a11y';\r\nimport Animation from '../../utils/animation';\r\nimport { waitForElement } from '../../utils/waitForElement';\r\nimport { InnoModalSize } from './inno-modal.model';\r\n\r\n/**\r\n * Represents the main frame of the modal component.\r\n */\r\n@Component({\r\n  tag: 'inno-modal',\r\n  styleUrl: 'inno-modal.scss',\r\n  scoped: true,\r\n})\r\nexport class InnoModal {\r\n  private ariaAttributes: A11yAttributes = {};\r\n\r\n  @Element() hostElement!: HTMLElement;\r\n\r\n  @State() modalVisible = false;\r\n\r\n  /**\r\n   * Theme variant of the component.\r\n   */\r\n  @Prop({ mutable: true }) variant: 'dark' | 'light' = 'light';\r\n\r\n  /**\r\n   * Modal size\r\n   */\r\n  @Prop() size: InnoModalSize = '720';\r\n\r\n  /**\r\n   * Should the modal be animated\r\n   */\r\n  @Prop() animation = true;\r\n\r\n  /**\r\n   * Show a backdrop behind the modal dialog\r\n   */\r\n  @Prop() backdrop = true;\r\n\r\n  /**\r\n   * Dismiss modal on backdrop click\r\n   */\r\n  @Prop() closeOnBackdropClick = true;\r\n\r\n  /**\r\n   * Centered modal\r\n   */\r\n  @Prop() centered = false;\r\n\r\n  /**\r\n   * By default the modal always opens at the top and the InnoModal component automatically scrolls to it.\r\n   * Set this to true if you want the modal to be always in a fixed position no matter where you scroll.\r\n   */\r\n  @Prop() fixed: boolean = false;\r\n\r\n  /**\r\n   * If set to true the modal can be closed by pressing the Escape key\r\n   */\r\n  @Prop() closeOnEscape = true;\r\n\r\n  /**\r\n   * Dialog close\r\n   */\r\n  @Event() dialogClose: EventEmitter;\r\n\r\n  /**\r\n   * Dialog cancel\r\n   */\r\n  @Event() dialogDismiss: EventEmitter;\r\n\r\n  private clickStartedInsideDialog: boolean | undefined = undefined;\r\n\r\n  get dialog() {\r\n    return this.hostElement.querySelector('dialog');\r\n  }\r\n\r\n  componentDidLoad() {\r\n    this.slideInModal();\r\n  }\r\n\r\n  componentWillLoad() {\r\n    this.ariaAttributes = a11yHostAttributes(this.hostElement);\r\n  }\r\n\r\n  // Handle keydown on modal content window\r\n  @Listen('keydown')\r\n  onKey(e: KeyboardEvent) {\r\n    if (e.key === 'Escape') {\r\n      e.preventDefault();\r\n      if (this.closeOnEscape) {\r\n        this.dismissModal();\r\n      } else {\r\n        e.stopPropagation();\r\n      }\r\n    } else {\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the dialog.\r\n   */\r\n  @Method()\r\n  async showModal() {\r\n    try {\r\n      const dialog = await waitForElement<HTMLDialogElement>('dialog', this.hostElement);\r\n      this.modalVisible = true;\r\n      dialog.showModal();\r\n\r\n      if (!this.fixed) {\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });\r\n      }\r\n    } catch (e) {\r\n      console.error('HTMLDialogElement not existing');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Dismiss the dialog\r\n   */\r\n  @Method()\r\n  async dismissModal<T = any>(reason?: T) {\r\n    this.slideOutModal(() => {\r\n      this.modalVisible = false;\r\n      this.dialog.close(JSON.stringify({ type: 'dismiss', reason }));\r\n      this.dialogDismiss.emit(reason);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Close the dialog\r\n   */\r\n  @Method()\r\n  async closeModal<T = any>(reason: T) {\r\n    this.slideOutModal(() => {\r\n      this.dialog.close(JSON.stringify({ type: 'close', reason }));\r\n      this.dialogClose.emit(reason);\r\n    });\r\n  }\r\n\r\n  private slideInModal() {\r\n    const duration = this.animation ? Animation.mediumTime : 0;\r\n    let transformY = this.centered ? '-50%' : 40;\r\n\r\n    anime({\r\n      targets: this.dialog,\r\n      duration,\r\n      opacity: [0, 1],\r\n      translateY: [0, transformY],\r\n      translateX: ['-50%', '-50%'],\r\n      easing: 'easeOutSine',\r\n    });\r\n  }\r\n\r\n  private slideOutModal(completeCallback: Function) {\r\n    const duration = this.animation ? Animation.mediumTime : 0;\r\n    let transformY = this.centered ? '-50%' : 40;\r\n\r\n    anime({\r\n      targets: this.dialog,\r\n      duration,\r\n      opacity: [1, 0],\r\n      translateY: [transformY, 0],\r\n      translateX: ['-50%', '-50%'],\r\n      easing: 'easeInSine',\r\n      complete: () => {\r\n        if (completeCallback) {\r\n          completeCallback();\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  private onDialogCancel(event: Event) {\r\n    // Check escape default behavior on modal backdrop\r\n    if (!this.closeOnEscape) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n\r\n    // Cancel the default dialog close behaviour\r\n    event.preventDefault();\r\n    this.dismissModal();\r\n  }\r\n\r\n  private onModalClick(event: MouseEvent) {\r\n    if (event.target !== this.dialog) {\r\n      return;\r\n    }\r\n\r\n    if (!this.isClickInsideDialog(event) && this.closeOnBackdropClick && !this.clickStartedInsideDialog) {\r\n      this.clickStartedInsideDialog = undefined;\r\n      this.dismissModal();\r\n    }\r\n    this.clickStartedInsideDialog = undefined;\r\n  }\r\n\r\n  private onMouseDown(event: MouseEvent) {\r\n    if (this.closeOnBackdropClick && this.isClickInsideDialog(event)) {\r\n      this.clickStartedInsideDialog = true;\r\n    } else {\r\n      this.clickStartedInsideDialog = false;\r\n    }\r\n  }\r\n\r\n  private isClickInsideDialog(event: MouseEvent): boolean {\r\n    const rect = this.dialog.getBoundingClientRect();\r\n    return rect.top <= event.clientY && event.clientY <= rect.top + rect.height && rect.left <= event.clientX && event.clientX <= rect.left + rect.width;\r\n  }\r\n\r\n  private dialogElement() {\r\n    const classes = {\r\n      modal: true,\r\n      fixed: this.fixed,\r\n      [`modal-size-${this.size}`]: true,\r\n    };\r\n\r\n    return (\r\n      <div class=\"dialog-backdrop\">\r\n        <dialog\r\n          aria-modal={a11yBoolean(true)}\r\n          aria-describedby={this.ariaAttributes['aria-describedby']}\r\n          aria-labelledby={this.ariaAttributes['aria-labelledby']}\r\n          class={classes}\r\n          onClick={e => this.onModalClick(e)}\r\n          onCancel={e => this.onDialogCancel(e)}\r\n          onMouseDown={e => this.onMouseDown(e)}\r\n        >\r\n          <slot></slot>\r\n        </dialog>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const hostClasses = {\r\n      'visible': this.modalVisible,\r\n      'no-backdrop': !this.backdrop,\r\n      'align-center': this.centered,\r\n    };\r\n\r\n    return <Host class={hostClasses}>{this.dialogElement()}</Host>;\r\n  }\r\n}\r\n"]}