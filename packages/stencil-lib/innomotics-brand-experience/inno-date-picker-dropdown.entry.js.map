{"file":"inno-date-picker-dropdown.entry.esm.js","mappings":"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","names":["DateTime"],"sources":["src/components/inno-date-picker-dropdown/inno-date-picker-dropdown.scss?tag=inno-date-picker-dropdown&encapsulation=scoped","src/components/inno-date-picker-dropdown/inno-date-picker-dropdown.tsx"],"sourcesContent":["@use '../../../styles/colors' as colors;\r\n\r\n:host {\r\n  display: block;\r\n  position: relative;\r\n  width: 100%;\r\n  max-width: 380px;\r\n  height: 56px;\r\n}\r\n\r\n.picker {\r\n  width: 100%;\r\n  height: 56px;\r\n  padding-left: 16px;\r\n  padding-right: 16px;\r\n\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  position: relative;\r\n\r\n  font-size: 16px;\r\n  font-family: 'InnomoticsHafferSQ';\r\n\r\n  cursor: pointer;\r\n\r\n  &.light {\r\n    border: 1px solid colors.$secondary-400;\r\n    color: colors.$secondary-800;\r\n  }\r\n\r\n  &.dark {\r\n    border: 1px solid colors.$secondary-400;\r\n    background-color: colors.$primary-200;\r\n    color: colors.$secondary-300;\r\n  }\r\n\r\n  .picker-label--hasvalue {\r\n    position: absolute;\r\n    top: 6px;\r\n    left: 16px;\r\n    font-size: 12px;\r\n  }\r\n\r\n  .picker-value {\r\n    position: relative;\r\n    top: 7px;\r\n  }\r\n\r\n  .picker-icon {\r\n    margin-left: auto;\r\n\r\n    &.light {\r\n      color: colors.$primary-200;\r\n    }\r\n\r\n    &.dark {\r\n      color: colors.$primary-300;\r\n    }\r\n  }\r\n}\r\n\r\n.dropdown-container {\r\n  display: none;\r\n  z-index: 10;\r\n  position: fixed;\r\n}\r\n\r\n.show {\r\n  display: block;\r\n}","import { autoUpdate, computePosition, flip, shift } from '@floating-ui/dom';\r\nimport { Component, Host, h, Element, State, Prop, Event, EventEmitter, Watch, Listen } from '@stencil/core';\r\nimport { DateChange } from '../inno-date-context-api/inno-date-api';\r\nimport { isPresent } from '../../utils/utils';\r\nimport { DateTime } from 'luxon';\r\n\r\n/**\r\n * Date-picker with dropdown.\r\n */\r\n@Component({\r\n  tag: 'inno-date-picker-dropdown',\r\n  styleUrl: 'inno-date-picker-dropdown.scss',\r\n  scoped: true,\r\n})\r\nexport class InnoDatePickerDropdown {\r\n  @Element() hostElement: HTMLElement;\r\n\r\n  /**\r\n   * Color variant of the component.\r\n   */\r\n  @Prop() variant: 'dark' | 'light' = 'dark';\r\n\r\n  /**\r\n   * Date format string.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() format: string = 'yyyy/LL/dd';\r\n\r\n  /**\r\n   * If true a date-range can be selected.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() range: boolean = false;\r\n\r\n  /**\r\n   * The selected starting range.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() from: string | undefined;\r\n\r\n  /**\r\n   * The selected end date.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() to: string | undefined;\r\n\r\n  /**\r\n   * The earliest date that can be selected by the date picker.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() minDate: string;\r\n\r\n  /**\r\n   * The latest date that can be selected by the date picker.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() maxDate: string;\r\n\r\n  /**\r\n   * The index of which day to start the week on.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() weekStartIndex = 0;\r\n\r\n  /**\r\n   * Format of the date strings.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() locale: string = undefined;\r\n\r\n  /**\r\n   * Show the days outside the selected month.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Prop() showOuterDays: boolean = true;\r\n\r\n  /**\r\n   * Label of the dropdown component.\r\n   */\r\n  @Prop() label: string | undefined;\r\n\r\n  @Prop() closeOnSelection = true;\r\n\r\n  /**\r\n   * Triggers if the date selection changes.\r\n   * See the date-picker component for more information.\r\n   */\r\n  @Event() dateChange: EventEmitter<DateChange>;\r\n\r\n  @State() show: boolean = false;\r\n  @State() isOpen: boolean = false;\r\n  @State() value: string | undefined;\r\n  @State() selectedRange: DateChange | undefined;\r\n\r\n  private dropdownHost: HTMLElement;\r\n  private datePicker: HTMLElement;\r\n  private disposeAutoUpdate?: () => void;\r\n\r\n  private destroyAutoUpdate() {\r\n    if (this.disposeAutoUpdate != undefined) {\r\n      this.disposeAutoUpdate();\r\n    }\r\n  }\r\n\r\n  private async computeTooltipPositionWithAutoUpdate() {\r\n    await this.computeTooltipPos();\r\n\r\n    return new Promise<void>((resolve) => {\r\n      this.disposeAutoUpdate = autoUpdate(\r\n        this.dropdownHost,\r\n        this.datePicker,\r\n        async () => {\r\n          await this.computeTooltipPos();\r\n          resolve();\r\n        },\r\n        {\r\n          ancestorResize: true,\r\n          ancestorScroll: true,\r\n          elementResize: true,\r\n          layoutShift: true\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  async computeTooltipPos() {\r\n    return new Promise<void>(async (resolve) => {\r\n      const positionConfig = await computePosition(this.dropdownHost, this.datePicker, {\r\n        placement: 'bottom',\r\n        strategy: 'fixed',\r\n        middleware: [\r\n          shift(),\r\n          flip({\r\n            mainAxis: true,\r\n            crossAxis: true,\r\n            fallbackAxisSideDirection: 'start',\r\n            fallbackStrategy: 'bestFit',\r\n            padding: 5\r\n          })\r\n        ]\r\n      });\r\n\r\n      this.datePicker.style.left = `${positionConfig.x}`;\r\n      this.datePicker.style.top = `${positionConfig.y}`;\r\n\r\n      const { x, y } = positionConfig;\r\n      Object.assign(this.datePicker.style, {\r\n        left: x !== null ? `${x}px` : '',\r\n        top: y !== null ? `${y - 1}px` : ''\r\n      });\r\n\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  private changeVisibility() {\r\n    this.isOpen = !this.isOpen;\r\n  }\r\n\r\n  @Watch('isOpen')\r\n  isOpenChanged() {\r\n    if (this.isOpen) {\r\n      this.computeTooltipPositionWithAutoUpdate().then(() => {\r\n        this.show = true;\r\n      });\r\n    } else {\r\n      this.show = false;\r\n      this.destroyAutoUpdate();\r\n    }\r\n  }\r\n\r\n  @Listen('keydown', { target: 'window' })\r\n  keyboardHandler(ev: KeyboardEvent) {\r\n    if (ev.key == 'Escape' && this.isOpen) {\r\n      this.isOpen = false;\r\n    }\r\n  }\r\n\r\n  @Listen('click', { target: 'window' })\r\n  async onClick(event: globalThis.Event) {\r\n    if (this.isOpen && this.show) {\r\n      if (event.target !== this.hostElement && !this.hostElement.contains(event.target as Node)) {\r\n        this.isOpen = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  private onDateChange(range: DateChange) {\r\n    if (range.to) {\r\n      this.value = `${range.from} - ${range.to}`;\r\n    } else {\r\n      this.value = range.from;\r\n    }\r\n\r\n    if (this.closeOnSelection) {\r\n      // close if not in range mode and value is selected\r\n      if (!this.range) {\r\n        this.isOpen = false;\r\n      }\r\n      // close if range mode and both values are selected\r\n      else if (this.range && range.to) {\r\n        this.isOpen = false;\r\n      }\r\n    }\r\n\r\n    this.dateChange.emit(range);\r\n  }\r\n\r\n  @Watch('from')\r\n  watchFromPropHandler(newValue: string) {\r\n    let fromDate = newValue ? DateTime.fromFormat(newValue, this.format) : undefined;\r\n\r\n    if (fromDate?.isValid) {\r\n      this.onDateChange({ from: newValue, to: this.to });\r\n    }\r\n  }\r\n\r\n  @Watch('to')\r\n  watchToPropHandler(newValue: string) {\r\n    let toDate = newValue ? DateTime.fromFormat(newValue, this.format) : undefined;\r\n\r\n    if (toDate?.isValid) {\r\n      this.onDateChange({ from: this.from, to: newValue });\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.destroyAutoUpdate();\r\n  }\r\n\r\n  private variantClasses() {\r\n    return {\r\n      light: this.variant === 'light',\r\n      dark: this.variant === 'dark',\r\n    };\r\n  }\r\n\r\n  private picker() {\r\n    const pickerClasses = {\r\n      ...this.variantClasses(),\r\n      picker: true,\r\n    };\r\n\r\n    const label = isPresent(this.label) ? this.label : 'Starting date*';\r\n    const labelClasses = {\r\n      ...this.variantClasses(),\r\n      'picker-label': true,\r\n      'picker-label--hasvalue': this.value !== undefined,\r\n    };\r\n\r\n    const valueClasses = {\r\n      'picker-value': true,\r\n    };\r\n\r\n    const iconName = this.show ? 'chevron_up_small' : 'calendar';\r\n    const pickerIconClasses = {\r\n      ...this.variantClasses(),\r\n      'picker-icon': true,\r\n    };\r\n\r\n    return (\r\n      <div class={pickerClasses} ref={ref => (this.dropdownHost = ref)} onClick={_ => this.changeVisibility()}>\r\n        <div class={labelClasses}>\r\n          <span>{label}</span>\r\n        </div>\r\n        <div class={valueClasses}>{this.value}</div>\r\n        <div class={pickerIconClasses}>\r\n          <inno-icon icon={iconName} size={32}></inno-icon>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private calendarContainer() {\r\n    const dropdownContainerClasses = {\r\n      ...this.variantClasses(),\r\n      'dropdown-container': true,\r\n      'show': this.show,\r\n    };\r\n\r\n    return (\r\n      <div class={dropdownContainerClasses} ref={ref => (this.datePicker = ref)}>\r\n        <inno-date-picker\r\n          format={this.format}\r\n          range={this.range}\r\n          from={this.from}\r\n          to={this.to}\r\n          minDate={this.minDate}\r\n          maxDate={this.maxDate}\r\n          weekStartIndex={this.weekStartIndex}\r\n          locale={this.locale}\r\n          showOuterDays={this.showOuterDays}\r\n          onDateChange={event => this.onDateChange(event.detail)}\r\n        ></inno-date-picker>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        {this.picker()}\r\n        {this.calendarContainer()}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}